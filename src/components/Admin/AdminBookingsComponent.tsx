import { useCollectionData } from "react-firebase-hooks/firestore";
import { db } from "../../firebase";
import BookingCard from "./BookingCard";
import { IBookingState } from "../../models/IBookingState";
import Spinner from "../Bookings/ChildComponents/Spinner";
import { Link } from "react-router-dom";

export const AdminBookingsComponent = () => {
  // Getting the collection and sorting it after date
  const bookinsRef = db.collection("bookings").orderBy("date");

  //Fetching data by using a firebase hook.
  const [snapshot, loading, error] =
    useCollectionData<IBookingState>(bookinsRef);

  const bookingCards = snapshot?.map((booking, i) => {
    return <BookingCard bookingObj={booking} key={i} />;
  });

  return (
    <main className="admin-bookings-page">
      <Link to="/">
        <svg
          width="211"
          height="63"
          viewBox="0 0 211 63"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          className="admin-logo "
        >
          <path
            d="M3.74805 15H2.57617L5.18359 0H6.35547L3.74805 15ZM11.0918 15.1953C10.2454 15.1823 9.51302 14.9479 8.89453 14.4922C8.27604 14.0299 7.82031 13.4049 7.52734 12.6172C7.24089 11.8229 7.13997 10.9668 7.22461 10.0488L7.25391 9.7168C7.34505 8.74023 7.63477 7.8125 8.12305 6.93359C8.61133 6.04818 9.22982 5.37435 9.97852 4.91211C10.7272 4.44336 11.528 4.21875 12.3809 4.23828C13.1686 4.2513 13.8327 4.46615 14.373 4.88281C14.9199 5.29948 15.3171 5.87891 15.5645 6.62109C15.8118 7.36328 15.89 8.18359 15.7988 9.08203L15.7207 9.79492H8.40625L8.37695 10.0293C8.2793 10.7389 8.33138 11.4193 8.5332 12.0703C8.73503 12.7148 9.0638 13.2292 9.51953 13.6133C9.98177 13.9909 10.5352 14.1862 11.1797 14.1992C11.8047 14.2188 12.3678 14.0983 12.8691 13.8379C13.3704 13.5775 13.8327 13.2292 14.2559 12.793L14.9395 13.3496C14.4642 13.9616 13.8978 14.4271 13.2402 14.7461C12.5892 15.0586 11.873 15.2083 11.0918 15.1953ZM12.3223 5.23438C11.4759 5.20182 10.7174 5.5013 10.0469 6.13281C9.3763 6.76432 8.87174 7.65299 8.5332 8.79883L14.666 8.80859L14.6953 8.66211C14.8125 7.73763 14.6497 6.94336 14.207 6.2793C13.7643 5.60872 13.1361 5.26042 12.3223 5.23438ZM21.1113 1.72852L20.6426 4.43359H22.7617L22.5957 5.39062H20.4766L19.3047 12.4414L19.2852 13.0469C19.2852 13.7565 19.6107 14.1211 20.2617 14.1406C20.4635 14.1471 20.7793 14.1243 21.209 14.0723L21.1602 15.0293C20.776 15.14 20.3854 15.1888 19.9883 15.1758C19.3047 15.1628 18.8066 14.9251 18.4941 14.4629C18.1816 13.9941 18.0677 13.3171 18.1523 12.4316L19.3145 5.39062H17.4199L17.5957 4.43359H19.4707L19.9492 1.72852H21.1113ZM25.1152 4.28711L24.4219 3.74023C25.112 2.93294 25.5417 2.1224 25.7109 1.30859L25.9453 0H27.0879L26.9121 1.11328C26.7103 2.38932 26.1113 3.44727 25.1152 4.28711ZM32.4883 12.2461C32.5924 11.3477 32.0456 10.6966 30.8477 10.293L29.168 9.79492C27.625 9.27409 26.8958 8.40495 26.9805 7.1875C27.026 6.30859 27.4297 5.5957 28.1914 5.04883C28.9596 4.49544 29.8711 4.22526 30.9258 4.23828C31.9609 4.2513 32.8008 4.54427 33.4453 5.11719C34.0898 5.68359 34.3893 6.44206 34.3438 7.39258H33.1914C33.2305 6.76107 33.0319 6.24674 32.5957 5.84961C32.166 5.45247 31.5931 5.2474 30.877 5.23438C30.1348 5.23438 29.5098 5.41016 29.002 5.76172C28.4941 6.10677 28.2077 6.56576 28.1426 7.13867C28.0449 7.97852 28.5592 8.56771 29.6855 8.90625L30.9062 9.25781L31.5605 9.48242C33.0319 10.0358 33.7253 10.9375 33.6406 12.1875C33.5885 13.0339 33.2207 13.7305 32.5371 14.2773C31.86 14.8177 30.9844 15.1204 29.9102 15.1855L29.5098 15.1953C28.8001 15.1823 28.1589 15.0456 27.5859 14.7852C27.013 14.5182 26.5736 14.1471 26.2676 13.6719C25.9616 13.1966 25.8281 12.6497 25.8672 12.0312L27.0293 12.041C27.0293 12.7051 27.2539 13.2292 27.7031 13.6133C28.1523 13.9974 28.7708 14.196 29.5586 14.209C30.3398 14.209 31.0039 14.0332 31.5508 13.6816C32.0977 13.3236 32.4102 12.8451 32.4883 12.2461Z"
            fill="#FF7B51"
          />
          <path
            d="M16.9878 43.873H8.30615L5.74268 49H0.222656L13.5186 24.1172H18.1499L22.8838 49H17.7739L16.9878 43.873ZM10.3569 39.7202H16.3555L14.9541 30.4575L10.3569 39.7202ZM34.2656 30.1499C35.986 30.1955 37.376 30.8848 38.4355 32.2178L40.2471 22.75H45.0835L40.5376 49H36.231L36.5044 47.0176C35.1258 48.624 33.5194 49.4045 31.6851 49.3589C30.5343 49.3475 29.526 49.0456 28.6602 48.4531C27.7943 47.8607 27.1221 47.0119 26.6436 45.9067C26.1764 44.7902 25.9201 43.5483 25.8745 42.1812C25.8403 41.4634 25.8574 40.7684 25.9258 40.0962L26.0283 39.3271C26.3018 37.4359 26.8258 35.7725 27.6006 34.3369C28.3867 32.9014 29.3438 31.8361 30.4717 31.1411C31.611 30.4461 32.8757 30.1157 34.2656 30.1499ZM30.7622 40.0962C30.6711 40.9621 30.6426 41.6912 30.6768 42.2837C30.7907 44.2889 31.5996 45.3086 33.1035 45.3428C34.4593 45.3997 35.6385 44.7617 36.6411 43.4287L37.957 36.0801C37.5127 34.861 36.624 34.223 35.291 34.166C34.1175 34.1318 33.1377 34.5876 32.3516 35.5332C31.5768 36.4674 31.047 37.9884 30.7622 40.0962ZM52.0903 30.4917L51.6973 32.5938C53.1898 30.9303 54.9956 30.1214 57.1147 30.167C58.2541 30.1898 59.1997 30.4518 59.9517 30.9531C60.7036 31.4544 61.2106 32.1323 61.4727 32.9868C63.1019 31.0614 65.016 30.1214 67.2148 30.167C68.9124 30.2012 70.1885 30.7822 71.043 31.9102C71.9089 33.0381 72.2734 34.6673 72.1367 36.7979L72.1025 37.2251L70.1372 49H65.3008L67.2661 37.1909C67.3117 36.7694 67.3288 36.3763 67.3174 36.0117C67.2376 34.8154 66.554 34.2002 65.2666 34.166C63.945 34.166 62.8114 34.8724 61.8657 36.2852L61.8145 36.6782L59.6611 49H54.8418L56.8071 37.2251C56.8527 36.8035 56.8698 36.4105 56.8584 36.0459C56.7786 34.8382 56.1007 34.2173 54.8247 34.1831C53.6056 34.1489 52.5062 34.7243 51.5264 35.9092L49.2192 49H44.3999L47.5957 30.5088L52.0903 30.4917ZM79.0581 49H74.2046L77.4175 30.5088H82.271L79.0581 49ZM77.9814 25.8091C77.9587 25.0457 78.2093 24.4134 78.7334 23.9121C79.2575 23.4108 79.8898 23.1602 80.6304 23.1602C81.3595 23.1374 81.9919 23.3595 82.5273 23.8267C83.0628 24.2938 83.342 24.8976 83.3647 25.6382C83.3875 26.3446 83.1483 26.9598 82.647 27.4839C82.1571 28.008 81.5133 28.2814 80.7158 28.3042C79.998 28.327 79.3657 28.1105 78.8188 27.6548C78.2834 27.1991 78.0042 26.5838 77.9814 25.8091ZM90.7817 30.4917L90.3716 32.6792C91.8527 30.9588 93.6471 30.1214 95.7549 30.167C97.498 30.2012 98.7855 30.8392 99.6172 32.0811C100.449 33.3229 100.751 35.0433 100.523 37.2422L98.5747 49H93.7554L95.7378 37.1909C95.7948 36.7466 95.8062 36.3421 95.772 35.9775C95.6239 34.8154 94.8947 34.2173 93.5845 34.1831C92.3198 34.1375 91.1862 34.7243 90.1836 35.9434L87.8765 49H83.0571L86.27 30.5088L90.7817 30.4917ZM107.461 49H102.608L105.821 30.5088H110.674L107.461 49ZM106.385 25.8091C106.362 25.0457 106.613 24.4134 107.137 23.9121C107.661 23.4108 108.293 23.1602 109.034 23.1602C109.763 23.1374 110.395 23.3595 110.931 23.8267C111.466 24.2938 111.745 24.8976 111.768 25.6382C111.791 26.3446 111.552 26.9598 111.05 27.4839C110.56 28.008 109.917 28.2814 109.119 28.3042C108.401 28.327 107.769 28.1105 107.222 27.6548C106.687 27.1991 106.408 26.5838 106.385 25.8091ZM122.278 43.7876C122.461 42.8761 121.828 42.2153 120.381 41.8052L118.826 41.4121C115.146 40.3981 113.357 38.6094 113.46 36.0459C113.517 34.3027 114.286 32.8843 115.767 31.7905C117.26 30.6854 119.054 30.1442 121.15 30.167C123.235 30.1898 124.922 30.7424 126.209 31.8247C127.496 32.9071 128.152 34.3483 128.174 36.1484L123.389 36.1313C123.412 34.5477 122.626 33.7445 121.031 33.7217C120.279 33.7217 119.624 33.9097 119.065 34.2856C118.519 34.6616 118.182 35.1686 118.057 35.8066C117.886 36.7181 118.576 37.3618 120.125 37.7378L120.809 37.8916C122.381 38.2676 123.583 38.7005 124.415 39.1904C125.246 39.6689 125.884 40.2671 126.329 40.9849C126.784 41.7026 126.995 42.5628 126.961 43.5654C126.927 44.7389 126.545 45.7643 125.816 46.6416C125.098 47.5189 124.107 48.1968 122.842 48.6753C121.589 49.1538 120.267 49.376 118.877 49.3418C116.827 49.319 115.118 48.7323 113.75 47.5815C112.383 46.4194 111.688 44.9212 111.666 43.0869L116.211 43.1211C116.257 44.887 117.203 45.7814 119.048 45.8042C119.937 45.8042 120.666 45.6219 121.236 45.2573C121.817 44.8927 122.164 44.4028 122.278 43.7876ZM138.975 25.9629L138.172 30.5088H141.248L140.616 34.1318H137.54L135.967 43.3945C135.899 43.9756 135.944 44.4199 136.104 44.7275C136.264 45.0352 136.651 45.2004 137.266 45.2231C137.448 45.2345 137.938 45.2061 138.736 45.1377L138.394 48.9146C137.54 49.1994 136.617 49.3304 135.625 49.3076C134.042 49.2848 132.863 48.7892 132.088 47.8208C131.313 46.8524 130.994 45.5422 131.131 43.8901L132.72 34.1318H130.105L130.738 30.5088H133.353L134.139 25.9629H138.975ZM153.519 35.1401C152.858 35.0262 152.317 34.9692 151.895 34.9692C150.175 34.9237 148.813 35.5674 147.811 36.9004L145.674 49H140.855L144.068 30.5088L148.597 30.4917L148.152 32.7476C149.314 31.0044 150.75 30.1328 152.459 30.1328C152.938 30.1328 153.496 30.2126 154.134 30.3721L153.519 35.1401ZM163.619 49C163.471 48.5329 163.408 47.9746 163.431 47.3252C162.041 48.7152 160.468 49.3874 158.714 49.3418C157.096 49.319 155.752 48.7949 154.681 47.7695C153.621 46.7327 153.125 45.4567 153.194 43.9414C153.274 41.9248 154.117 40.381 155.723 39.3101C157.341 38.2277 159.506 37.6865 162.217 37.6865L164.473 37.7207L164.712 36.6099C164.781 36.2339 164.798 35.875 164.764 35.5332C164.707 34.9977 164.502 34.5819 164.148 34.2856C163.807 33.978 163.351 33.8185 162.781 33.8071C162.029 33.7843 161.391 33.9723 160.867 34.3711C160.343 34.7585 160.007 35.3224 159.859 36.063L155.022 36.0801C155.102 34.3141 155.911 32.8843 157.449 31.7905C158.999 30.6854 160.907 30.1442 163.174 30.167C165.271 30.2126 166.911 30.8392 168.096 32.0469C169.281 33.2432 169.777 34.7869 169.583 36.6782L168.165 45.5308L168.079 46.6245C168.056 47.4334 168.153 48.117 168.37 48.6753L168.353 49H163.619ZM159.91 45.5991C161.3 45.6447 162.514 45.0409 163.55 43.7876L164.148 40.5918L162.474 40.5747C160.696 40.6203 159.415 41.1615 158.628 42.1982C158.344 42.5742 158.167 43.0356 158.099 43.5825C158.007 44.1978 158.133 44.6877 158.475 45.0522C158.828 45.4054 159.306 45.5877 159.91 45.5991ZM181.084 25.9629L180.281 30.5088H183.357L182.725 34.1318H179.649L178.077 43.3945C178.008 43.9756 178.054 44.4199 178.213 44.7275C178.373 45.0352 178.76 45.2004 179.375 45.2231C179.558 45.2345 180.048 45.2061 180.845 45.1377L180.503 48.9146C179.649 49.1994 178.726 49.3304 177.735 49.3076C176.151 49.2848 174.972 48.7892 174.197 47.8208C173.423 46.8524 173.104 45.5422 173.24 43.8901L174.83 34.1318H172.215L172.847 30.5088H175.462L176.248 25.9629H181.084ZM191.749 49.3418C190.131 49.3304 188.695 48.9373 187.442 48.1626C186.2 47.3765 185.271 46.3055 184.656 44.9497C184.041 43.5825 183.802 42.0786 183.938 40.438L183.99 39.7544C184.161 37.9543 184.685 36.3022 185.562 34.7983C186.439 33.2944 187.567 32.138 188.946 31.3291C190.324 30.5088 191.851 30.1214 193.526 30.167C195.907 30.2126 197.707 31.0898 198.926 32.7988C200.157 34.4964 200.624 36.6497 200.328 39.2588L200.054 41.3608H188.724C188.678 42.5571 188.969 43.5142 189.595 44.2319C190.222 44.9497 191.076 45.32 192.159 45.3428C193.913 45.3883 195.451 44.7104 196.773 43.3091L198.978 46.0435C198.283 47.0916 197.28 47.9119 195.97 48.5044C194.66 49.0854 193.252 49.3646 191.749 49.3418ZM193.287 34.1489C192.398 34.1261 191.606 34.4053 190.911 34.9863C190.228 35.5674 189.612 36.5757 189.065 38.0112H195.696L195.799 37.5669C195.867 37.1112 195.873 36.6782 195.816 36.2681C195.702 35.6073 195.423 35.0946 194.979 34.73C194.534 34.354 193.97 34.1603 193.287 34.1489Z"
            fill="#FF7B51"
          />
          <path d="M2 52.418H201.438V54.127H2V52.418Z" fill="#FF7B51" />
        </svg>
      </Link>
      {loading && <Spinner />}
      {!loading && (
        <section className="booking-cards-container">{bookingCards}</section>
      )}
      {error && error.message.toString()}
    </main>
  );
};
